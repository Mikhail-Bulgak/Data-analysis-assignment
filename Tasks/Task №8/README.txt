Есть база данных Отдела продаж (PostgreSQL), куда загружаются данные об ответах менеджеров в сделках в amoCRM. Диалог с каждым клиентом ведётся внутри своей сделки. 

Необходимо: 
1. Написать SQL-запрос, который будет рассчитывать среднее время ответа для каждого менеджера/пары менеджеров. 
Расчёт должен учитывать следующее: 
	• если в диалоге идут несколько сообщений подряд от клиента или менеджера, то при расчёте времени ответа надо учитывать только первое сообщение из каждого блока; 
	• менеджеры работают с 09:30 до 00:00, поэтому нерабочее время не должно учитываться в расчёте среднего времени ответа, т.е. если клиент написал в 23:59, а менеджер ответил в 09:30 – время ответа равно одной минуте; 
	• ответы на сообщения, пришедшие ночью также нужно учитывать. 
2. На основе базы данных из первого задания построить дашборд в DataLens с данными о среднем времени ответа менеджеров. Виды визуализаций и структура отчёта произвольные, однако необходима возможность фильтровать данные по дням, менеджерам и начальникам отделов продаж. 
3. Также при помощи Python написать скрипт, который будет рассчитывать среднее время ответа для каждого менеджера/пары менеджеров.

Доступные таблицы: 
• chat_messages 
• managers 
• rops 

chat_messages - Здесь хранятся данные о входящих и исходящих сообщениях внутри сделок 

| Имя | Тип | Описание |
|-----|-----|----------|

|message_id| varchar | Уникальный идентификатор сообщения |
|---|---|---|
|type| varchar | Тип сообщения: 
	         outgoing_chat_message – исходящее сообщение от менеджера клиенту 
	         incoming_chat_message – входящее сообщение от клиента менеджеру|
|---|---|---|
|entity_id| int | Идентификатор сделки в amoCRM. На каждого клиента открывается отдельная сделка |
|---|---|---|
|created_by| int | Идентификатор того, кто написал сообщение. У клиентов всегда 0. 
	          Список соответствия идентификаторов менеджеров и их имён находится в таблице managers|
|---|---|---|
|created_at| int | Время создания сообщения в формате Unix Timestamp |
|---|---|---|


managers - Здесь хранятся данные о менеджерах 

mop_id 	int 	Уникальный идентификатор менеджера
name_mop 	varchar 	Имя менеджера/пары менеджеров
rop_id 	varchar 	Уникальный идентификатор руководителя отдела продаж, в чём отделе работает менеджер


rops - Здесь хранятся данные о руководителях Отдела продаж

rop_id 	int 	Уникальный идентификатор руководителя отдела продаж
rop_name 	varchar 	Имя руководителя отдела продаж

